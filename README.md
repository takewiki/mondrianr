Mondrian Schema Generator
=====
Package `mondrianr` creates Mondrian schema for given table. It's goal is to enable easy analysis of single tables stored in PostgreSQL or R in Mondrian compatible tools. [Mondrian](http://mondrian.pentaho.com/documentation/olap.php) is an open source OLAP engine.

`mondrianr` works well with [Saiku](http://meteorite.bi/saiku) - an open source analytical tool for OLAP data. Given Mondrian schema and data source definition file (both generated by `mondrianr`), Saiku gives you highly interactive environment for data analysis. 
Data analysis in Saiku is similar to using pivot tables in Excel or Libre Office. To better understand how Saiku can help you analyze data, I highly recommend to try online [demo](http://demo.analytical-labs.com/).

Note: When creating traditional Mondrian schema we typically work with on fact table (where measures are stored) and one or more dimensions. For example we can have fact table with sales amount and keys to dimensions like time, product, customer, ... `mondrianr` builds schema in such way that input table is both fact table and dimension at the same time. While this is not traditional design, it still complies with Mondrian schema definition.

Main features
------------------

 - Generates Mondrian schema for PostgreSQL table or R data frame
 - Generates datasource definition for Saiku
 - Optionally maps date columns to existing time dimension (PostgreSQL)
 - Optionally maps date columns to automatically generated time dimension (R data frame)
 - User can define what aggregators will be used
 - User can define what columns will be used as dimensions
 
Main functions
-----------------
 - create_schema() - function to generate mondrian schema
 
Installation:
----------------
### Install `mondrianr`
``` 
     library(devtools)
     install_github('mondrianr','tomasgreif')
     library(mondrianr)
```
Note: `mondrianr` requires packages `sqldf` and `RSQLite`

### Install Saiku
Follow this [guide](http://docs.analytical-labs.com/saiku/documentation/2013/08/15/quickstart.html). Download `SQLite` 
[driver](https://bitbucket.org/xerial/sqlite-jdbc/downloads) and copy it to correct folder.
 
### Test everything works

For R data frame
```
library(mondrianr)

data(big_portfolio)
big_portfolio$origination_date <- as.Date(big_portfolio$origination_date)
big_portfolio$repayment_date <- as.Date(big_portfolio$repayment_date,format='%Y-%m-%d')
str(big_portfolio)

create_schema(engine='R',
              table='big_portfolio',
              primary_key='id',
              time_table = 'any_name',
              schema_dest='~/Applications/Saiku/saiku-server/tomcat/webapps/saiku/WEB-INF/classes/foodmart/test.xml',
              data_source_dest='~/Applications/Saiku/saiku-server/tomcat/webapps/saiku/WEB-INF/classes/saiku-datasources/test')
```
For PostgreSQL table:

 - import data frame `big_portfolio` to PostgreSQL

```
create_schema(engine='PostgreSQL',
               table='public.big_portfolio',
               primary_key='id',
               con=c('usr','pwd','db','host','port'),
               schema_dest='~/Applications/Saiku/saiku-server/tomcat/webapps/saiku/WEB-INF/classes/foodmart/test.xml',
               data_source_dest='~/Applications/Saiku/saiku-server/tomcat/webapps/saiku/WEB-INF/classes/saiku-datasources/test')
```               

If anything goes well, than you can get something like the following in Saiku:

![alt tag](http://www.analytikdat.cz/images/easyblog_images/923/99999999-jednorazove-obrazky/mondrianr-saiku.png)
